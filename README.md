# NIST CVE Search tool
Quick search CVEs via NIST endpoint.

### Requirements
* Python 3

## Usage
Comes with a help/usage message via `-h` or `--help` that will highlight information about how to utilize the tool:

```bash
» python3 search.py -h
usage: search.py [-h] [-s] -y YEAR [-c COUNT] search

positional arguments:
  search                Search query (regex capable)

optional arguments:
  -h, --help            show this help message and exit
  -s, --short           Print short version of each CVE entry
  -y YEAR, --year YEAR  Year to look for. Examples: '2020' (single) or '2019,2020' (list) or '2010-2020' (range)
  -c COUNT, --count COUNT
                        Number of results to display
```

Simple search for 2020 CVEs (`-y`) mentioning Citrix using `-c 1` (count) to print only one report and `-s` to print a simplified version:

```bash
» python3 search.py -s -y 2020 -c 1 Citrix

ID: CVE-2020-10110
DATE: 2020-03-06T21:15Z
IMPACT:
    Base Score: 5.3
    Severity: MEDIUM
    Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N

DESC: ** DISPUTED ** Citrix Gateway 11.1, 12.0, and 12.1 allows Information Exposure Through Caching. NOTE: Citrix disputes this as not a vulnerability. There is no sensitive information disclosure through the cache headers on Citrix ADC. The "Via" header lists cache protocols and recipients between the start and end points for a request or a response. The "Age" header provides the age of the cached response in seconds. Both headers are commonly used for proxy cache and the information is not sensitive.
```

The tool will print the reports in two formats: JSON and simplified (seen previously). JSON output makes it easy to later use it as input for another application or parse its content. For example, using `jq` we can get details of the reports we searched for previously and print ID and Severity together:

```bash
 » python3 search.py -y 2020 Citrix | jq -r '.[]|[.cve.CVE_data_meta.ID,(.impact.baseMetricV2|if .severity == null then "N/A" else .severity end)]|@tsv'
CVE-2020-10110  MEDIUM
CVE-2020-10111  MEDIUM
CVE-2020-10112  MEDIUM
CVE-2020-13884  HIGH
CVE-2020-13885  HIGH
CVE-2020-13998  MEDIUM
CVE-2020-6175   MEDIUM
CVE-2020-7473   MEDIUM
CVE-2020-8187   MEDIUM
CVE-2020-8190   MEDIUM
CVE-2020-8191   MEDIUM
CVE-2020-8193   MEDIUM
CVE-2020-8194   MEDIUM
CVE-2020-8195   MEDIUM
CVE-2020-8196   MEDIUM
CVE-2020-8197   MEDIUM
CVE-2020-8198   MEDIUM
CVE-2020-8199   MEDIUM
CVE-2020-8200   MEDIUM
CVE-2020-8207   MEDIUM
CVE-2020-8208   MEDIUM
CVE-2020-8209   MEDIUM
CVE-2020-8210   MEDIUM
CVE-2020-8211   HIGH
CVE-2020-8212   HIGH
CVE-2020-8217   LOW
CVE-2020-8245   MEDIUM
CVE-2020-8246   MEDIUM
CVE-2020-8247   MEDIUM
CVE-2020-8253   MEDIUM
CVE-2020-8271   N/A
CVE-2020-8272   N/A
CVE-2020-8273   N/A
CVE-2020-8982   MEDIUM
CVE-2020-8983   MEDIUM
```

You can also specify multiple years in list format like `2011,2014,2016` or as a range `2015-2020`.
The searches are also regex capable, so using regular expressions can bring more results to your searches or be more specific:

```bash
 » python3 search.py -s -y 2020 'Citrix (XenMobile|Storefront) server' | grep DESC
DESC: Improper authentication in Citrix StoreFront Server < 1912.0.1000 allows an attacker who is authenticated on the same Microsoft Active Directory domain as a Citrix StoreFront server to read arbitrary files from that server.
DESC: Improper input validation in Citrix XenMobile Server 10.12 before RP1, Citrix XenMobile Server 10.11 before RP4, Citrix XenMobile Server 10.11 before RP6 and Citrix XenMobile Server before 10.9 RP5 allows Cross-Site Scripting (XSS).
DESC: Improper access control in Citrix XenMobile Server 10.12 before RP2, Citrix XenMobile Server 10.11 before RP4, Citrix XenMobile Server 10.10 before RP6 and Citrix XenMobile Server before 10.9 RP5 and leads to the ability to read arbitrary files.
DESC: Insufficient protection of secrets in Citrix XenMobile Server 10.12 before RP3, Citrix XenMobile Server 10.11 before RP6, Citrix XenMobile Server 10.10 RP6 and Citrix XenMobile Server before 10.9 RP5 discloses credentials of a service account.
DESC: Improper input validation in Citrix XenMobile Server 10.12 before RP3, Citrix XenMobile Server 10.11 before RP6, Citrix XenMobile Server 10.10 RP6 and Citrix XenMobile Server before 10.9 RP5 allows SQL Injection.
DESC: Improper access control in Citrix XenMobile Server 10.12 before RP3, Citrix XenMobile Server 10.11 before RP6, Citrix XenMobile Server 10.10 RP6 and Citrix XenMobile Server before 10.9 RP5 allows access to privileged functionality.
DESC: Improper authentication in Citrix XenMobile Server 10.12 before RP2, Citrix XenMobile Server 10.11 before RP4, Citrix XenMobile Server 10.10 before RP6 and Citrix XenMobile Server before 10.9 RP5 leads to the ability to access sensitive files.
```

## Contributors
* Lisandro Ubiedo (lisandro.ubiedo[at]gmail[dot]com)
